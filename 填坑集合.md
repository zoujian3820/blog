# 填坑大集合
> 工作久了总会遇到各种各样的巨坑，时间长了总会有遗忘的时候，故此开始慢慢收集平时所遇的难题和解决办法

**1. 微信项目在使用jssdk时，spa单页项目在ios上invalid signature天坑**

- IOS：微信IOS版，微信安卓版，每次切换路由，SPA的url是不会变的，发起签名请求的url参数必须是当前页面的url就是最初进入页面时的url

- Android：微信安卓版，每次切换路由，SPA的url是会变的，发起签名请求的url参数必须是当前页面的url(不是最初进入页面时的)

- **解决方案：**
- 全局存储进入SPA的url（window.entryUrl），Android不变，依旧是获取当前页面的url，IOS就使用window.entryUrl，然后签名，done！
  ```javascript
  // 记录进入app的url，后面微信sdk
  if (window.entryUrl === '') {
    window.entryUrl = location.href.split('#')[0]
  }
  // 进行签名的时候
  url: isAndroid() ? location.href.split('#')[0] : window.entryUrl
  ```
  - [参考资料](https://juejin.im/post/5a3cc5ae5188252103347221)